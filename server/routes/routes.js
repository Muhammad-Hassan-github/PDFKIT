let dataObj = {
  "headers": {
    "title": "Order to",
    "date": "Order date",
    "invoiceId": "Order nr",
    "noVat": "VAT Statement:",
    "note": "Note:",
    "page": "Page",
    "payment_terms": "Payment Terms:",
    "total": "Total",
    "totals": {
      "noDiscount": "Total Order",
      "discount": "Total Discount (10%)",
      "vatCategories": [
        {
          "category": "9",
          "totalPrice": "Total 9% Vat Category",
          "totalVat": "9% Vat"
        }
      ],
      "totalProducts": "Products",
      "exVat": "Total Ex Vat",
      "incVat": "TOTAL",
      "vat": "Total Vat"
    },
    "products": {
      "code": "Code",
      "contents": "Contents",
      "description": "Description",
      "price": "Price",
      "quantity": "Qty",
      "total": "Total Price",
      "vat": "Vat"
    },
    "profile": {
      "debtorId": "Debtor ID"
    },
    "customer": {
      "coc": "CoC",
      "email": "Email",
      "fax": "Fax",
      "mobile": "Mobile",
      "telephone": "Tel",
      "vat": "Vat",
      "website": "Website"
    }
  },
  "profile": {
    "city": "Hengelo",
    "coc": "76119572",
    "country": "Nederland",
    "email": "emrahhanokruiden40@gmail.com",
    "fax": "",
    "image": "https://newflow.orapay.io/api/v1/images/a6b92c249dc5c913354121257f6992f5_13abbbbc909a6cac42eb654607bab1bdb33d4bd60dcacf0600383f38d33da99565c1ca4b9773c7e469f2b13b27dc5732d09bc425a49ad7569018278cf156ce6cb4ca0249bb17874a10908330d03f895c6673a3baf06031731f9b56e73e749161bc43532a2d9c24d698c13021219ada7c",
    "mobile": "+31642114250",
    "name": "Or.a Trade Solutions BV",
    "street": "Agonstraat",
    "streetNumber": "8",
    "telephone": "+31642114250",
    "vat": "NL860514298B01",
    "website": "www.ora-ts.com",
    "zip": "7552 TJ"
  },
  "customer": {
    "coc": "1",
    "country": "Zimbabue",
    "city": "Harare",
    "debtorId": "123",
    "name": "Acme",
    "streetNumber": "123",
    "street": "Robert mugabe ave",
    "vatApplicable": 1,
    "zip": "0123"
  },
  "products": [
    {
      "description": "Amsterdammertje . (200 gr)",
      "code": "AH-357528",
      "invoicePrice": "$2.66",
      "vat": "9%",
      "contents": "1",
      "quantity": 1,
      "total": "$2.66"
    },
    {
      "description": "Amsterdammertje . (500 gr)",
      "code": "AH-357529",
      "invoicePrice": "$5.6",
      "vat": "9%",
      "contents": "1",
      "quantity": 4,
      "total": "$22.4"
    },
    {
      "description": "Bacardi & Cola 4 pack (4 x 0,25 l gr)",
      "code": "AH-178075",
      "invoicePrice": "$7.79",
      "vat": "9%",
      "contents": "1",
      "quantity": 2,
      "total": "$15.58"
    },
    {
      "description": "Chocomel , fles (1000 ml)",
      "code": "AH-188164",
      "invoicePrice": "$1.53",
      "vat": "9%",
      "contents": "1",
      "quantity": 1,
      "total": "$1.53"
    },
    {
      "description": "Danone & Fruit magere yoghurt kers (125 gr)",
      "code": "AH-222039",
      "invoicePrice": "$1.95",
      "vat": "9%",
      "contents": "4",
      "quantity": 3,
      "total": "$5.85"
    },
    {
      "description": "Danone & Fruit volle yoghurt mix (125 gr)",
      "code": "AH-222042",
      "invoicePrice": "$3.49",
      "vat": "9%",
      "contents": "8",
      "quantity": 2,
      "total": "$6.98"
    },
    {
      "description": "Dauvergne Ranvier & Ranvier Grd Vin Cotes du Rhone (4500 ml)",
      "code": "AH-448226",
      "invoicePrice": "$83.94",
      "vat": "9%",
      "contents": "1",
      "quantity": 1,
      "total": "$83.94"
    },
    {
      "description": "Elke Melk . (800 ml)",
      "code": "AH-460620",
      "invoicePrice": "$1.39",
      "vat": "9%",
      "contents": "1",
      "quantity": 1,
      "total": "$1.39"
    },
    {
      "description": "Gulden Draak . (330 ml)",
      "code": "AH-201936",
      "invoicePrice": "$1.45",
      "vat": "9%",
      "contents": "1",
      "quantity": 3,
      "total": "$4.35"
    },
    {
      "description": "HG (combi) magnetron reiniger (500 ml)",
      "code": "AH-170821",
      "invoicePrice": "$3.89",
      "vat": "9%",
      "contents": "1",
      "quantity": 1,
      "total": "$3.89"
    },
    {
      "description": "Jack Daniels & Lynchburg lemon (330 ml)",
      "code": "AH-436939",
      "invoicePrice": "$2.39",
      "vat": "9%",
      "contents": "1",
      "quantity": 1,
      "total": "$2.39"
    },
    {
      "description": "Klene 'n Berg zoet gesuikerd (450 gr)",
      "code": "AH-213580",
      "invoicePrice": "$1.98",
      "vat": "9%",
      "contents": "1",
      "quantity": 3,
      "total": "$5.94"
    },
    {
      "description": "Klene 'n Berg zoete drop (450 gr)",
      "code": "AH-213581",
      "invoicePrice": "$1.98",
      "vat": "9%",
      "contents": "1",
      "quantity": 3,
      "total": "$5.94"
    },
    {
      "description": "La Chouffe + glas (4 x 0.33l gr)",
      "code": "AH-403940",
      "invoicePrice": "$11.49",
      "vat": "9%",
      "contents": "1",
      "quantity": 1,
      "total": "$11.49"
    },
    {
      "description": "Malibu & Cola (250 ml)",
      "code": "AH-198900",
      "invoicePrice": "$1.95",
      "vat": "9%",
      "contents": "1",
      "quantity": 1,
      "total": "$1.95"
    },
    {
      "description": "Malibu & Pineapple (250 ml)",
      "code": "AH-211399",
      "invoicePrice": "$1.89",
      "vat": "9%",
      "contents": "1",
      "quantity": 1,
      "total": "$1.89"
    },
    {
      "description": "Maltesers . (192 gr)",
      "code": "AH-238097",
      "invoicePrice": "$2.09",
      "vat": "9%",
      "contents": "1",
      "quantity": 1,
      "total": "$2.09"
    },
    {
      "description": "Nutella & go (39 gr)",
      "code": "AH-370830",
      "invoicePrice": "$3.09",
      "vat": "9%",
      "contents": "2",
      "quantity": 1,
      "total": "$3.09"
    },
    {
      "description": "Nutella & Go (39 gr)",
      "code": "8868",
      "invoicePrice": "$0.49",
      "vat": "9%",
      "contents": "1",
      "quantity": 3,
      "total": "$1.47"
    },
    {
      "description": "Perrier & juice aardbei kiwi (250 ml)",
      "code": "AH-437934",
      "invoicePrice": "$2.75",
      "vat": "9%",
      "contents": "4",
      "quantity": 3,
      "total": "$8.25"
    },
    {
      "description": "Perrier & juice perzik kers (250 ml)",
      "code": "AH-437932",
      "invoicePrice": "$2.75",
      "vat": "9%",
      "contents": "4",
      "quantity": 1,
      "total": "$2.75"
    },
    {
      "description": "Pure blonde . (250 ml)",
      "code": "AH-435204",
      "invoicePrice": "$3.9",
      "vat": "9%",
      "contents": "6",
      "quantity": 1,
      "total": "$3.9"
    },
    {
      "description": "Sao Miguel do Sul . (750 ml)",
      "code": "AH-382911",
      "invoicePrice": "$5.99",
      "vat": "9%",
      "contents": "1",
      "quantity": 1,
      "total": "$5.99"
    },
    {
      "description": "Tripel Karmeliet . (330 ml)",
      "code": "AH-438908",
      "invoicePrice": "$6.89",
      "vat": "9%",
      "contents": "4",
      "quantity": 1,
      "total": "$6.89"
    },
    {
      "description": "Some product with VAT 21",
      "code": "AH-435908",
      "invoicePrice": "$150",
      "vat": "21%",
      "contents": "4",
      "quantity": 1,
      "total": "$150"
    },
    {
      "description": "Some other product with VAT 21",
      "code": "AH-538908",
      "invoicePrice": "$50",
      "vat": "21%",
      "contents": "4",
      "quantity": 1,
      "total": "$50"
    }
  ],
  "date": "2020-03-18",
  "totals": {
    "vatCategories": [
      {
        "category": "9",
        "totalPrice": "$191.34",
        "totalVat": "$17.22"
      },
      {
        "category": "21",
        "totalPrice": "$200",
        "totalVat": "$42"
      }
    ],
    "discount": "$41.26",
    "exVat": "$371.34",
    "incVat": "$430.56",
    "noDiscount": "$412.60",
    "totalProducts": 43,
    "vat": "$59.22",
    "total": "$430.56"
  },
  "settings": {
    "paymentTerms": "Within 14 days after invoice date.",
    "note": "Some note to customers",
    "footer": "This should show on each page at the footer.",
    "primaryColor": "#bbdefb",
    "secondaryColor": "#e3f2fd"
  },
  "invoiceId": "ORD-123-000037"
}


var dotenv = require('dotenv');
var path = require("path")
const PDFDocument = require('pdfkit');
const fs = require('fs');
const invoice = {
  shipping: {
    name: "John Doe",
    address: "1234 Main Street",
    city: "San Francisco",
    state: "CA",
    country: "US",
    postal_code: 94111
  },
  items: [
    {
      item: "TC 100",
      description: "Toner Cartridge",
      quantity: 2,
      amount: 6000
    },
    {
      item: "USB_EXT",
      description: "USB Cable Extender",
      quantity: 1,
      amount: 2000
    }
  ],
  subtotal: 8000,
  paid: 0,
  invoice_nr: 1234
};

dotenv.config();
console.log(dataObj.products.length)




module.exports = function (server) {
  server.get('/generatePdf', (req, res) => {
    let doc = new PDFDocument({ margin: 50 });
    function generateHeader(doc) {
      doc
        .image(__dirname + '/img.jpg', 40, 30, { fit: [180, 230] })
        .roundedRect(365, 30, 220, 210, 10)
        .fillAndStroke(`${dataObj.settings.primaryColor}`, `${dataObj.settings.primaryColor}`)
        .fill('black').stroke()
        .fontSize(15).font('Helvetica-Bold').text(`${dataObj.headers.title}:`, 40, 110)
        .fontSize(12).font('Times-Bold').text("Hajo Janse", 40, 140)
        .fontSize(9)
        .font('Times-Roman').text("Damaschkering 3", 40, 170)
        .text("48599, Gronau", 40, 180)
        .text("Germany", 40, 190)

        .text(`Debtor: ${dataObj.headers.profile.debtorId}`, 40, 220)
        .text(`Vat: ${dataObj.headers.products.vat}`, 40, 230)

        .text("Tel:", 380, 110)
        .text("Mobile:", 380, 130)
        .text("Email:", 380, 150)
        .text("Website:", 380, 170)
        .text("CoC:", 380, 190)
        .text("Vat:", 380, 210)

        .fontSize(10).font('Helvetica-Bold').text("Or.a Trade Solutions BV", 0, 50, { align: "right" })
        .fontSize(9).font('Times-Roman').text("Agonstraat 8", 0, 70, { align: "right" })
        .text("7552 TJ, Hengelo", 0, 80, { align: "right" })
        .text("Nederland", 0, 90, { align: "right" })

        .text(`${dataObj.headers.customer.telephone}`, 0, 110, { align: "right" })
        .text(`${dataObj.headers.customer.mobile}`, 0, 130, { align: "right" })
        .text(`${dataObj.headers.customer.coc}`, 0, 150, { align: "right" })
        .text(`${dataObj.headers.customer.vat}`, 0, 170, { align: "right" })
        .text(`${dataObj.headers.customer.email}`, 0, 190, { align: "right" })
        .text(`${dataObj.headers.customer.website}`, 0, 210, { align: "right" })

        .fontSize(10)
        .roundedRect(50, 270, 530, 30, 8)
        .fillAndStroke('white', `${dataObj.settings.primaryColor}`)
        .fill('black').stroke()

        .text("Order nr", 120, 275)
        .text("Order date", 240, 275)
        .text("Products", 360, 275)
        .text("Page", 480, 275)

        .font('Times-Bold').text(`${dataObj.headers.invoiceId}`, 100, 285)
        .text(`${dataObj.headers.date}`, 240, 285)
        .text(`${dataObj.headers.totals.totalProducts}`, 370, 285)
        .text(`${dataObj.headers.page}`, 480, 285)


        .font('Times-Roman').roundedRect(50, 340, 520, 0, 0)
        .fillAndStroke('white', `${dataObj.settings.primaryColor}`)
        .fill('black').stroke()

        .font('Times-Bold').text("#", 50, 325)
        .text("Code", 70, 325)
        .text("Description", 130, 325)
        .text("Contents", 355, 325)
        .text("Vat", 405, 325)       
        .text("Qty", 435, 325)
        .text("Price", 480, 325)
        .text("Total", 0, 325, { align: "right" })

      //  -----------start-footer------------

      doc.font('Times-Roman').roundedRect(50, doc.page.height - 35, 520, 0, 0)
        .fillAndStroke('white', `${dataObj.settings.primaryColor}`)
        .fill('black').stroke()
      doc.text('footer footer  footer  footer  footer  footer', 250, doc.page.height - 30, {
        align: "center",
        lineBreak: false,
      });

      //  -----------start-footer------------





    }


    // function generateFooter(doc) {
    //   doc
    //     .fontSize(10)
    //     .text(
    //       "Payment is due within 15 days. Thank you for your business.",
    //       50,
    //       780,
    //       { align: "center", width: 500 }
    //     );
    // }
    // function generateCustomerInformation(doc, invoice) {
    //   const shipping = invoice.shipping;

    //   doc
    //     .text(`Invoice Number: ${invoice.invoice_nr}`, 50, 200)
    //     .text(`Invoice Date: ${new Date()}`, 50, 215)
    //     .text(`Balance Due: ${invoice.subtotal - invoice.paid}`, 50, 130)

    //     .text(shipping.name, 300, 200)
    //     .text(shipping.address, 300, 215)
    //     .text(`${shipping.city}, ${shipping.state}, ${shipping.country}`, 500, 130)
    //     .moveDown();
    // }

    function generateTableRow(doc, y, c1, c2, c3, c4, c5, c6, c7, c8) {
      doc
        .fontSize(9)
        .font('Times-Roman')
        .font('Times-Bold').text(c1, 50, y)
        .font('Times-Roman').text(c2, 70, y)
        .text(c3, 130, y)
        .text(c4, 380, y)
        .text(c5, 410, y)
        .text(c6, 440, y)
        .text(c7, 480, y)
        .text(c8, 0, y, { align: "right" });

    }

    function generateInvoiceTable(doc, invoice) {
      let i,
        invoiceTableTop = 340;

      let pageNo = 1;

      for (i = 0; i < dataObj.products.length; i++) {

        const item = dataObj.products[i];

        function lastResult() {
          doc
            .roundedRect(465, 30 + invoiceTableTop + dataObj.products.length * 10, 100, 20, 0)
            .fillAndStroke(`${dataObj.settings.primaryColor}`)
            .fill('black').stroke()
            .text(`Total Order    ${dataObj.headers.totals.noDiscount}`, 50, 35 + invoiceTableTop + dataObj.products.length * 10, { align: "right" })

            .roundedRect(400, 50 + invoiceTableTop + dataObj.products.length * 10, 165, 20, 0)
            .fillAndStroke(`${dataObj.settings.secondaryColor}`)
            .fill('black').stroke()
            .text(`Total Discount (10%)  ${dataObj.headers.totals.discount}`, 50, 55 + invoiceTableTop + dataObj.products.length * 10, { align: "right" })

            .roundedRect(390, 70 + invoiceTableTop + dataObj.products.length * 10, 175, 20, 0)
            .fillAndStroke(`${dataObj.settings.primaryColor}`)
            .fill('black').stroke()
            .text(`Total 9% Vat Category   ${dataObj.headers.totals.vatCategories[0].totalPrice}`, 50, 75 + invoiceTableTop + dataObj.products.length * 10, { align: "right" })

            .roundedRect(465, 90 + invoiceTableTop + dataObj.products.length * 10, 100, 20, 0)
            .fillAndStroke(`${dataObj.settings.secondaryColor}`)
            .fill('black').stroke()
            .text(`Total Ex Vat  ${dataObj.headers.totals.exVat}`, 50, 95 + invoiceTableTop + dataObj.products.length * 10, { align: "right" })

            .roundedRect(500, 110 + invoiceTableTop + dataObj.products.length * 10, 65, 20, 0)
            .fillAndStroke(`${dataObj.settings.primaryColor}`)
            .fill('black').stroke()
            .text(`9% Vat   ${dataObj.headers.totals.vatCategories[0].totalVat}`, 50, 115 + invoiceTableTop + dataObj.products.length * 10, { align: "right" })

            .roundedRect(485, 130 + invoiceTableTop + dataObj.products.length * 10, 80, 20, 0)
            .fillAndStroke(`${dataObj.settings.secondaryColor}`)
            .fill('black').stroke()
            .text(`Total Vat   ${dataObj.headers.totals.vat}`, 50, 135 + invoiceTableTop + dataObj.products.length * 10, { align: "right" })

            // .roundedRect(450, 150+invoiceTableTop + dataObj.products.length * 10, 100, 20, 0)
            // .fillAndStroke( 'white')
            // .fill('black').stroke()


            .roundedRect(510, 160 + invoiceTableTop + dataObj.products.length * 10, 55, 20, 0)
            .fillAndStroke(`${dataObj.settings.primaryColor}`)
            .fill('black').stroke()
            .text(`TOTAL  ${dataObj.headers.total}`, 50, 165 + invoiceTableTop + dataObj.products.length * 10, { align: "right" })


            // note
            .text("Payment Terms: Within 30 days after invoice date.", 50, 180 + dataObj.products.length * 10)
          // note



        }


        if (i < 38) {
          console.log("1", i)
          const position = invoiceTableTop + (i + 1) * 10;
          generateTableRow(
            doc,
            position,
            i + 1,
            item.code,
            item.description,
            item.contents,
            item.vat,
            item.quantity,
            item.invoicePrice,
            item.total,

          );

        }
        if (dataObj.products.length > 22 && dataObj.products.length < 39) {
          console.log("legnth", dataObj.products.length)

          if (dataObj.products.length == i + 1) {
            doc.addPage({
              margin: 50
            })
            //  -----------start-footer------------

            doc.font('Times-Roman').roundedRect(50, doc.page.height - 35, 520, 0, 0)
              .fillAndStroke('white', `${dataObj.settings.primaryColor}`)
              .fill('black').stroke()
            doc.text('footer footer  footer  footer  footer  footer', 250, doc.page.height - 30, {
              align: "center",
              lineBreak: false,
            });

            //  -----------start-footer------------

            doc
              .roundedRect(465, 30 + (26 - 25) * 10, 100, 20, 0)
              .fillAndStroke(`${dataObj.settings.primaryColor}`)
              .fill('black').stroke()
              .text(`Total Order    ${dataObj.headers.totals.noDiscount}`, 50, 35 + (26 - 25) * 10, { align: "right" })

              .roundedRect(400, 50 + (26 - 25) * 10, 165, 20, 0)
              .fillAndStroke(`${dataObj.settings.secondaryColor}`)
              .fill('black').stroke()
              .text(`Total Discount (10%)  ${dataObj.headers.totals.discount}`, 50, 55 + (26 - 25) * 10, { align: "right" })

              .roundedRect(390, 70 + (26 - 25) * 10, 175, 20, 0)
              .fillAndStroke(`${dataObj.settings.primaryColor}`)
              .fill('black').stroke()
              .text(`Total 9% Vat Category   ${dataObj.headers.totals.vatCategories[0].totalPrice}`, 50, 75 + (26 - 25) * 10, { align: "right" })

              .roundedRect(465, 90 + (26 - 25) * 10, 100, 20, 0)
              .fillAndStroke(`${dataObj.settings.secondaryColor}`)
              .fill('black').stroke()
              .text(`Total Ex Vat  ${dataObj.headers.totals.exVat}`, 50, 95 + (26 - 25) * 10, { align: "right" })

              .roundedRect(500, 110 + (26 - 25) * 10, 65, 20, 0)
              .fillAndStroke(`${dataObj.settings.primaryColor}`)
              .fill('black').stroke()
              .text(`9% Vat   ${dataObj.headers.totals.vatCategories[0].totalVat}`, 50, 115 + (26 - 25) * 10, { align: "right" })

              .roundedRect(485, 130 + (26 - 25) * 10, 80, 20, 0)
              .fillAndStroke(`${dataObj.settings.secondaryColor}`)
              .fill('black').stroke()
              .text(`Total Vat   ${dataObj.headers.totals.vat}`, 50, 135 + (26 - 25) * 10, { align: "right" })

              // .roundedRect(450, 150 + dataObj.products.length * 10, 100, 20, 0)
              // .fillAndStroke( 'white')
              // .fill('black').stroke()


              .roundedRect(510, 160 + (26 - 25) * 10, 55, 20, 0)
              .fillAndStroke(`${dataObj.settings.primaryColor}`)
              .fill('black').stroke()
              .text(`TOTAL  ${dataObj.headers.total}`, 50, 165 + (26 - 25) * 10, { align: "right" })




              // note
              .text("Payment Terms: Within 30 days after invoice date.", 50, 180 + (26 - 25) * 10)
            // note




          }


        } else if (dataObj.products.length <= 22) {
          console.log("3")

          if (dataObj.products.length == i + 1) {
            lastResult()
          }
        }
        if (i >= 38 && i < 105) {
          console.log("4", i)

          if (i == 38) {
            doc.addPage({
              margin: 50
            })
            //  -----------start-footer------------

            doc.font('Times-Roman').roundedRect(50, doc.page.height - 35, 520, 0, 0)
              .fillAndStroke('white', `${dataObj.settings.primaryColor}`)
              .fill('black').stroke()
            doc.text('footer footer  footer  footer  footer  footer', 250, doc.page.height - 30, {
              align: "center",
              lineBreak: false,
            });

            //  -----------start-footer------------

            doc.font('Times-Bold').text("#", 50, 50)
              .text("Code", 70, 50)
              .text("Description", 130, 50)
              .text("Contents", 355, 50)
              .text("Qty", 405, 50)
              .text("Vat", 435, 50)
              .text("Price", 480, 50)
              .text("Total", 0, 50, { align: "right" })


              .font('Times-Roman').roundedRect(50, 65, 520, 0, 0)
              .fillAndStroke('white', `${dataObj.settings.primaryColor}`)
              .fill('black').stroke()


          }

          const position = 50 + ((i - 37) + 1) * 10;
          generateTableRow(
            doc,
            position,
            i + 1,
            item.code,
            item.description,
            item.contents,
            item.vat,
            item.quantity,
            item.invoicePrice,
            item.total,

          );

          if (i < 86) {
            if (dataObj.products.length == i + 1) {
              doc
                .roundedRect(465, 30 + (dataObj.products.length - 30) * 10, 100, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`Total Order    ${dataObj.headers.totals.noDiscount}`, 50, 35 + (dataObj.products.length - 30) * 10, { align: "right" })

                .roundedRect(400, 50 + (dataObj.products.length - 30) * 10, 165, 20, 0)
                .fillAndStroke(`${dataObj.settings.secondaryColor}`)
                .fill('black').stroke()
                .text(`Total Discount (10%)  ${dataObj.headers.totals.discount}`, 50, 55 + (dataObj.products.length - 30) * 10, { align: "right" })

                .roundedRect(390, 70 + (dataObj.products.length - 30) * 10, 175, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`Total 9% Vat Category   ${dataObj.headers.totals.vatCategories[0].totalPrice}`, 50, 75 + (dataObj.products.length - 30) * 10, { align: "right" })

                .roundedRect(465, 90 + (dataObj.products.length - 30) * 10, 100, 20, 0)
                .fillAndStroke(`${dataObj.settings.secondaryColor}`)
                .fill('black').stroke()
                .text(`Total Ex Vat  ${dataObj.headers.totals.exVat}`, 50, 95 + (dataObj.products.length - 30) * 10, { align: "right" })

                .roundedRect(500, 110 + (dataObj.products.length - 30) * 10, 65, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`9% Vat   ${dataObj.headers.totals.vatCategories[0].totalVat}`, 50, 115 + (dataObj.products.length - 30) * 10, { align: "right" })

                .roundedRect(485, 130 + (dataObj.products.length - 30) * 10, 80, 20, 0)
                .fillAndStroke(`${dataObj.settings.secondaryColor}`)
                .fill('black').stroke()
                .text(`Total Vat   ${dataObj.headers.totals.vat}`, 50, 135 + (dataObj.products.length - 30) * 10, { align: "right" })

                // .roundedRect(450, 150 + dataObj.products.length * 10, 100, 20, 0)
                // .fillAndStroke( 'white')
                // .fill('black').stroke()


                .roundedRect(510, 160 + (dataObj.products.length - 30) * 10, 55, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`TOTAL  ${dataObj.headers.total}`, 50, 165 + (dataObj.products.length - 30) * 10, { align: "right" })




                // note
                .text("Payment Terms: Within 30 days after invoice date.", 50, 180 + (dataObj.products.length - 30) * 10)
              // note





            }
          }
          else {


            if (dataObj.products.length == i + 1) {
              doc.addPage({
                margin: 50
              })
              //  -----------start-footer------------

              doc.font('Times-Roman').roundedRect(50, doc.page.height - 35, 520, 0, 0)
                .fillAndStroke('white', `${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
              doc.text('footer footer  footer  footer  footer  footer', 250, doc.page.height - 30, {
                align: "center",
                lineBreak: false,
              });

              //  -----------start-footer------------

              doc
                .roundedRect(465, 30 + (26 - 25) * 10, 100, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`Total Order    ${dataObj.headers.totals.noDiscount}`, 50, 35 + (26 - 25) * 10, { align: "right" })

                .roundedRect(400, 50 + (26 - 25) * 10, 165, 20, 0)
                .fillAndStroke(`${dataObj.settings.secondaryColor}`)
                .fill('black').stroke()
                .text(`Total Discount (10%)  ${dataObj.headers.totals.discount}`, 50, 55 + (26 - 25) * 10, { align: "right" })

                .roundedRect(390, 70 + (26 - 25) * 10, 175, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`Total 9% Vat Category   ${dataObj.headers.totals.vatCategories[0].totalPrice}`, 50, 75 + (26 - 25) * 10, { align: "right" })

                .roundedRect(465, 90 + (26 - 25) * 10, 100, 20, 0)
                .fillAndStroke(`${dataObj.settings.secondaryColor}`)
                .fill('black').stroke()
                .text(`Total Ex Vat  ${dataObj.headers.totals.exVat}`, 50, 95 + (26 - 25) * 10, { align: "right" })

                .roundedRect(500, 110 + (26 - 25) * 10, 65, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`9% Vat   ${dataObj.headers.totals.vatCategories[0].totalVat}`, 50, 115 + (26 - 25) * 10, { align: "right" })

                .roundedRect(485, 130 + (26 - 25) * 10, 80, 20, 0)
                .fillAndStroke(`${dataObj.settings.secondaryColor}`)
                .fill('black').stroke()
                .text(`Total Vat   ${dataObj.headers.totals.vat}`, 50, 135 + (26 - 25) * 10, { align: "right" })

                // .roundedRect(450, 150 + dataObj.products.length * 10, 100, 20, 0)
                // .fillAndStroke( 'white')
                // .fill('black').stroke()


                .roundedRect(510, 160 + (26 - 25) * 10, 55, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`TOTAL  ${dataObj.headers.total}`, 50, 165 + (26 - 25) * 10, { align: "right" })



                // note
                .text("Payment Terms: Within 30 days after invoice date.", 50, 180 + (26 - 25) * 10)
              // note




            }




          }






        }
        if (i >= 105 && i < 172) {


          if (i == 105) {
            doc.addPage({
              margin: 50
            })
            //  -----------start-footer------------

            doc.font('Times-Roman').roundedRect(50, doc.page.height - 35, 520, 0, 0)
              .fillAndStroke('white', `${dataObj.settings.primaryColor}`)
              .fill('black').stroke()
            doc.text('footer footer  footer  footer  footer  footer', 250, doc.page.height - 30, {
              align: "center",
              lineBreak: false,
            });

            //  -----------start-footer------------
            doc.font('Times-Bold').text("#", 50, 50)
              .text("Code", 70, 50)
              .text("Description", 130, 50)
              .text("Contents", 355, 50)
              .text("Qty", 405, 50)
              .text("Vat", 435, 50)
              .text("Price", 480, 50)
              .text("Total", 0, 50, { align: "right" })


              .font('Times-Roman').roundedRect(50, 65, 520, 0, 0)
              .fillAndStroke('white', `${dataObj.settings.primaryColor}`)
              .fill('black').stroke()


          }

          const position = 50 + ((i - 104) + 1) * 10;
          generateTableRow(
            doc,
            position,
            i + 1,
            item.code,
            item.description,
            item.contents,
            item.vat,
            item.quantity,
            item.invoicePrice,
            item.total,

          );

          if (i < 155) {
            if (dataObj.products.length == i + 1) {
              doc
                .roundedRect(465, 30 + (dataObj.products.length - 100) * 10, 100, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`Total Order    ${dataObj.headers.totals.noDiscount}`, 50, 35 + (dataObj.products.length - 100) * 10, { align: "right" })

                .roundedRect(400, 50 + (dataObj.products.length - 100) * 10, 165, 20, 0)
                .fillAndStroke(`${dataObj.settings.secondaryColor}`)
                .fill('black').stroke()
                .text(`Total Discount (10%)  ${dataObj.headers.totals.discount}`, 50, 55 + (dataObj.products.length - 100) * 10, { align: "right" })

                .roundedRect(390, 70 + (dataObj.products.length - 100) * 10, 175, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`Total 9% Vat Category   ${dataObj.headers.totals.vatCategories[0].totalPrice}`, 50, 75 + (dataObj.products.length - 100) * 10, { align: "right" })

                .roundedRect(465, 90 + (dataObj.products.length - 100) * 10, 100, 20, 0)
                .fillAndStroke(`${dataObj.settings.secondaryColor}`)
                .fill('black').stroke()
                .text(`Total Ex Vat  ${dataObj.headers.totals.exVat}`, 50, 95 + (dataObj.products.length - 100) * 10, { align: "right" })

                .roundedRect(500, 110 + (dataObj.products.length - 100) * 10, 65, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`9% Vat   ${dataObj.headers.totals.vatCategories[0].totalVat}`, 50, 115 + (dataObj.products.length - 100) * 10, { align: "right" })

                .roundedRect(485, 130 + (dataObj.products.length - 100) * 10, 80, 20, 0)
                .fillAndStroke(`${dataObj.settings.secondaryColor}`)
                .fill('black').stroke()
                .text(`Total Vat   ${dataObj.headers.totals.vat}`, 50, 135 + (dataObj.products.length - 100) * 10, { align: "right" })

                // .roundedRect(450, 150 + dataObj.products.length * 10, 100, 20, 0)
                // .fillAndStroke( 'white')
                // .fill('black').stroke()


                .roundedRect(510, 160 + (dataObj.products.length - 100) * 10, 55, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`TOTAL  ${dataObj.headers.total}`, 50, 165 + (dataObj.products.length - 100) * 10, { align: "right" })


                // note
                .text("Payment Terms: Within 30 days after invoice date.", 50, 180 + (dataObj.products.length - 100) * 10)
              // note




            }
          }
          else {


            if (dataObj.products.length == i + 1) {
              doc.addPage({
                margin: 50
              })

              doc
                .roundedRect(465, 30 + (26 - 25) * 10, 100, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`Total Order    ${dataObj.headers.totals.noDiscount}`, 50, 35 + (26 - 25) * 10, { align: "right" })

                .roundedRect(400, 50 + (26 - 25) * 10, 165, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`Total Discount (10%)  ${dataObj.headers.totals.discount}`, 50, 55 + (26 - 25) * 10, { align: "right" })

                .roundedRect(390, 70 + (26 - 25) * 10, 175, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`Total 9% Vat Category   ${dataObj.headers.totals.vatCategories[0].totalPrice}`, 50, 75 + (26 - 25) * 10, { align: "right" })

                .roundedRect(465, 90 + (26 - 25) * 10, 100, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`Total Ex Vat  ${dataObj.headers.totals.exVat}`, 50, 95 + (26 - 25) * 10, { align: "right" })

                .roundedRect(500, 110 + (26 - 25) * 10, 65, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`9% Vat   ${dataObj.headers.totals.vatCategories[0].totalVat}`, 50, 115 + (26 - 25) * 10, { align: "right" })

                .roundedRect(485, 130 + (26 - 25) * 10, 80, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`Total Vat   ${dataObj.headers.totals.vat}`, 50, 135 + (26 - 25) * 10, { align: "right" })

                // .roundedRect(450, 150 + dataObj.products.length * 10, 100, 20, 0)
                // .fillAndStroke( 'white')
                // .fill('black').stroke()


                .roundedRect(510, 160 + (26 - 25) * 10, 55, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`TOTAL  ${dataObj.headers.total}`, 50, 165 + (26 - 25) * 10, { align: "right" })





            }




          }






        }
        if (i >= 172 && i < 239) {


          if (i == 172) {
            doc.addPage({
              margin: 50
            })
            //  -----------start-footer------------

            doc.font('Times-Roman').roundedRect(50, doc.page.height - 35, 520, 0, 0)
              .fillAndStroke('white', `${dataObj.settings.primaryColor}`)
              .fill('black').stroke()
            doc.text('footer footer  footer  footer  footer  footer', 250, doc.page.height - 30, {
              align: "center",
              lineBreak: false,
            });

            //  -----------start-footer------------
            doc.font('Times-Bold').text("#", 50, 50)
              .text("Code", 70, 50)
              .text("Description", 130, 50)
              .text("Contents", 355, 50)
              .text("Qty", 405, 50)
              .text("Vat", 435, 50)
              .text("Price", 480, 50)
              .text("Total", 0, 50, { align: "right" })


              .font('Times-Roman').roundedRect(50, 65, 520, 0, 0)
              .fillAndStroke('white', `${dataObj.settings.primaryColor}`)
              .fill('black').stroke()


          }

          const position = 50 + ((i - 171) + 1) * 10;
          generateTableRow(
            doc,
            position,
            i + 1,
            item.code,
            item.description,
            item.contents,
            item.vat,
            item.quantity,
            item.invoicePrice,
            item.total,

          );

          if (i < 220) {
            if (dataObj.products.length == i + 1) {
              doc
                .roundedRect(465, 30 + (dataObj.products.length - 165) * 10, 100, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`Total Order    ${dataObj.headers.totals.noDiscount}`, 50, 35 + (dataObj.products.length - 165) * 10, { align: "right" })

                .roundedRect(400, 50 + (dataObj.products.length - 165) * 10, 165, 20, 0)
                .fillAndStroke(`${dataObj.settings.secondaryColor}`)
                .fill('black').stroke()
                .text(`Total Discount (10%)  ${dataObj.headers.totals.discount}`, 50, 55 + (dataObj.products.length - 165) * 10, { align: "right" })

                .roundedRect(390, 70 + (dataObj.products.length - 165) * 10, 175, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`Total 9% Vat Category   ${dataObj.headers.totals.vatCategories[0].totalPrice}`, 50, 75 + (dataObj.products.length - 165) * 10, { align: "right" })

                .roundedRect(465, 90 + (dataObj.products.length - 165) * 10, 100, 20, 0)
                .fillAndStroke(`${dataObj.settings.secondaryColor}`)
                .fill('black').stroke()
                .text(`Total Ex Vat  ${dataObj.headers.totals.exVat}`, 50, 95 + (dataObj.products.length - 165) * 10, { align: "right" })

                .roundedRect(500, 110 + (dataObj.products.length - 165) * 10, 65, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`9% Vat   ${dataObj.headers.totals.vatCategories[0].totalVat}`, 50, 115 + (dataObj.products.length - 165) * 10, { align: "right" })

                .roundedRect(485, 130 + (dataObj.products.length - 165) * 10, 80, 20, 0)
                .fillAndStroke(`${dataObj.settings.secondaryColor}`)
                .fill('black').stroke()
                .text(`Total Vat   ${dataObj.headers.totals.vat}`, 50, 135 + (dataObj.products.length - 165) * 10, { align: "right" })

                // .roundedRect(450, 150 + dataObj.products.length * 10, 100, 20, 0)
                // .fillAndStroke( 'white')
                // .fill('black').stroke()


                .roundedRect(510, 160 + (dataObj.products.length - 165) * 10, 55, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`TOTAL  ${dataObj.headers.total}`, 50, 165 + (dataObj.products.length - 165) * 10, { align: "right" })



                // note
                .text("Payment Terms: Within 30 days after invoice date.", 50, 180 + (dataObj.products.length - 165) * 10)
              // note




            }
          }
          else {


            if (dataObj.products.length == i + 1) {
              doc.addPage({
                margin: 50
              })
              //  -----------start-footer------------

              doc.font('Times-Roman').roundedRect(50, doc.page.height - 35, 520, 0, 0)
                .fillAndStroke('white', `${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
              doc.text('footer footer  footer  footer  footer  footer', 250, doc.page.height - 30, {
                align: "center",
                lineBreak: false,
              });

              //  -----------start-footer------------
              doc
                .roundedRect(465, 30 + (26 - 25) * 10, 100, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`Total Order    ${dataObj.headers.totals.noDiscount}`, 50, 35 + (26 - 25) * 10, { align: "right" })

                .roundedRect(400, 50 + (26 - 25) * 10, 165, 20, 0)
                .fillAndStroke(`${dataObj.settings.secondaryColor}`)
                .fill('black').stroke()
                .text(`Total Discount (10%)  ${dataObj.headers.totals.discount}`, 50, 55 + (26 - 25) * 10, { align: "right" })

                .roundedRect(390, 70 + (26 - 25) * 10, 175, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`Total 9% Vat Category   ${dataObj.headers.totals.vatCategories[0].totalPrice}`, 50, 75 + (26 - 25) * 10, { align: "right" })

                .roundedRect(465, 90 + (26 - 25) * 10, 100, 20, 0)
                .fillAndStroke(`${dataObj.settings.secondaryColor}`)
                .fill('black').stroke()
                .text(`Total Ex Vat  ${dataObj.headers.totals.exVat}`, 50, 95 + (26 - 25) * 10, { align: "right" })

                .roundedRect(500, 110 + (26 - 25) * 10, 65, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`9% Vat   ${dataObj.headers.totals.vatCategories[0].totalVat}`, 50, 115 + (26 - 25) * 10, { align: "right" })

                .roundedRect(485, 130 + (26 - 25) * 10, 80, 20, 0)
                .fillAndStroke(`${dataObj.settings.secondaryColor}`)
                .fill('black').stroke()
                .text(`Total Vat   ${dataObj.headers.totals.vat}`, 50, 135 + (26 - 25) * 10, { align: "right" })

                // .roundedRect(450, 150 + dataObj.products.length * 10, 100, 20, 0)
                // .fillAndStroke( 'white')
                // .fill('black').stroke()


                .roundedRect(510, 160 + (26 - 25) * 10, 55, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`TOTAL  ${dataObj.headers.total}`, 50, 165 + (26 - 25) * 10, { align: "right" })



                // note
                .text("Payment Terms: Within 30 days after invoice date.", 50, 180 + (26 - 25) * 10)
              // note






            }




          }






        }
        if (i >= 239 && i < 306) {


          if (i == 239) {
            doc.addPage({
              margin: 50
            })
            //  -----------start-footer------------

            doc.font('Times-Roman').roundedRect(50, doc.page.height - 35, 520, 0, 0)
              .fillAndStroke('white', `${dataObj.settings.primaryColor}`)
              .fill('black').stroke()
            doc.text('footer footer  footer  footer  footer  footer', 250, doc.page.height - 30, {
              align: "center",
              lineBreak: false,
            });

            //  -----------start-footer------------
            doc.font('Times-Bold').text("#", 50, 50)
              .text("Code", 70, 50)
              .text("Description", 130, 50)
              .text("Contents", 355, 50)
              .text("Qty", 405, 50)
              .text("Vat", 435, 50)
              .text("Price", 480, 50)
              .text("Total", 0, 50, { align: "right" })


              .font('Times-Roman').roundedRect(50, 65, 520, 0, 0)
              .fillAndStroke('white', `${dataObj.settings.primaryColor}`)
              .fill('black').stroke()


          }

          const position = 50 + ((i - 238) + 1) * 10;
          generateTableRow(
            doc,
            position,
            i + 1,
            item.code,
            item.description,
            item.contents,
            item.vat,
            item.quantity,
            item.invoicePrice,
            item.total,

          );

          if (i < 285) {
            if (dataObj.products.length == i + 1) {
              doc
                .roundedRect(465, 30 + (dataObj.products.length - 230) * 10, 100, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`Total Order    ${dataObj.headers.totals.noDiscount}`, 50, 35 + (dataObj.products.length - 230) * 10, { align: "right" })

                .roundedRect(400, 50 + (dataObj.products.length - 230) * 10, 165, 20, 0)
                .fillAndStroke(`${dataObj.settings.secondaryColor}`)
                .fill('black').stroke()
                .text(`Total Discount (10%)  ${dataObj.headers.totals.discount}`, 50, 55 + (dataObj.products.length - 230) * 10, { align: "right" })

                .roundedRect(390, 70 + (dataObj.products.length - 230) * 10, 175, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`Total 9% Vat Category   ${dataObj.headers.totals.vatCategories[0].totalPrice}`, 50, 75 + (dataObj.products.length - 230) * 10, { align: "right" })

                .roundedRect(465, 90 + (dataObj.products.length - 230) * 10, 100, 20, 0)
                .fillAndStroke(`${dataObj.settings.secondaryColor}`)
                .fill('black').stroke()
                .text(`Total Ex Vat  ${dataObj.headers.totals.exVat}`, 50, 95 + (dataObj.products.length - 230) * 10, { align: "right" })

                .roundedRect(500, 110 + (dataObj.products.length - 230) * 10, 65, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`9% Vat   ${dataObj.headers.totals.vatCategories[0].totalVat}`, 50, 115 + (dataObj.products.length - 230) * 10, { align: "right" })

                .roundedRect(485, 130 + (dataObj.products.length - 230) * 10, 80, 20, 0)
                .fillAndStroke(`${dataObj.settings.secondaryColor}`)
                .fill('black').stroke()
                .text(`Total Vat   ${dataObj.headers.totals.vat}`, 50, 135 + (dataObj.products.length - 230) * 10, { align: "right" })

                // .roundedRect(450, 150 + dataObj.products.length * 10, 100, 20, 0)
                // .fillAndStroke( 'white')
                // .fill('black').stroke()


                .roundedRect(510, 160 + (dataObj.products.length - 230) * 10, 55, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`TOTAL  ${dataObj.headers.total}`, 50, 165 + (dataObj.products.length - 230) * 10, { align: "right" })


                // note
                .text("Payment Terms: Within 30 days after invoice date.", 50, 180 + (dataObj.products.length - 230) * 10)
              // note


            }
          }
          else {


            if (dataObj.products.length == i + 1) {
              doc.addPage({
                margin: 50
              })
              //  -----------start-footer------------

              doc.font('Times-Roman').roundedRect(50, doc.page.height - 35, 520, 0, 0)
                .fillAndStroke('white', `${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
              doc.text('footer footer  footer  footer  footer  footer', 250, doc.page.height - 30, {
                align: "center",
                lineBreak: false,
              });

              //  -----------start-footer------------
              doc
                .roundedRect(465, 30 + (26 - 25) * 10, 100, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`Total Order    ${dataObj.headers.totals.noDiscount}`, 50, 35 + (26 - 25) * 10, { align: "right" })

                .roundedRect(400, 50 + (26 - 25) * 10, 165, 20, 0)
                .fillAndStroke(`${dataObj.settings.secondaryColor}`)
                .fill('black').stroke()
                .text(`Total Discount (10%)  ${dataObj.headers.totals.discount}`, 50, 55 + (26 - 25) * 10, { align: "right" })

                .roundedRect(390, 70 + (26 - 25) * 10, 175, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`Total 9% Vat Category   ${dataObj.headers.totals.vatCategories[0].totalPrice}`, 50, 75 + (26 - 25) * 10, { align: "right" })

                .roundedRect(465, 90 + (26 - 25) * 10, 100, 20, 0)
                .fillAndStroke(`${dataObj.settings.secondaryColor}`)
                .fill('black').stroke()
                .text(`Total Ex Vat  ${dataObj.headers.totals.exVat}`, 50, 95 + (26 - 25) * 10, { align: "right" })

                .roundedRect(500, 110 + (26 - 25) * 10, 65, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`9% Vat   ${dataObj.headers.totals.vatCategories[0].totalVat}`, 50, 115 + (26 - 25) * 10, { align: "right" })

                .roundedRect(485, 130 + (26 - 25) * 10, 80, 20, 0)
                .fillAndStroke(`${dataObj.settings.secondaryColor}`)
                .fill('black').stroke()
                .text(`Total Vat   ${dataObj.headers.totals.vat}`, 50, 135 + (26 - 25) * 10, { align: "right" })

                // .roundedRect(450, 150 + dataObj.products.length * 10, 100, 20, 0)
                // .fillAndStroke( 'white')
                // .fill('black').stroke()


                .roundedRect(510, 160 + (26 - 25) * 10, 55, 20, 0)
                .fillAndStroke(`${dataObj.settings.primaryColor}`)
                .fill('black').stroke()
                .text(`TOTAL  ${dataObj.headers.total}`, 50, 165 + (26 - 25) * 10, { align: "right" })



                // note
                .text("Payment Terms: Within 30 days after invoice date.", 50, 180 + (26 - 25) * 10)
              // note

            }




          }






        }



      }


    }


    generateHeader(doc);
    generateInvoiceTable(doc, invoice);
    doc.end();
    doc.pipe(res)
  }
  )
}